<?xml version="1.0" encoding="UTF-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009"
	xmlns:s="library://ns.adobe.com/flex/spark" xmlns:mx="library://ns.adobe.com/flex/mx"
	xmlns:clue-components="clue.components.*" width="100%" height="100%"
	creationComplete="initApp();">
	<s:layout>
		<s:VerticalLayout />
	</s:layout>
	<s:states>
		<s:State name="login" />
		<s:State name="games" />
		<s:State name="prestart" stateGroups="clueGroup" />
		<s:State name="clue" stateGroups="clueGroup" />
		<s:State name="accuse" stateGroups="clueGroup" />
		<s:State name="suggest" stateGroups="clueGroup" />
		<s:State name="disprove" stateGroups="clueGroup" />
	</s:states>
	<fx:Script>
	<![CDATA[
		import mx.rpc.remoting.mxml.RemoteObject;
		import mx.rpc.events.ResultEvent;
		import mx.rpc.events.FaultEvent;
	
		private var key:String;
		private var username:String;
		//Handlers
		private function defaultServiceResultHandler(event:ResultEvent):void{}
		private function defaultServiceFaultHandler(event:FaultEvent):void{}
		
		private function logout():void{key=null;username=null;}
		private function successfulLogin(usernamein:String, keyin:String):void{username=usernamein;key=keyin;chat.text+=username;}
				
		private function initApp():void{
			ExternalInterface.addCallback("successfulLogin",successfulLogin);
			ExternalInterface.addCallback("logout",logout);
		}	
	]]>
	</fx:Script>
	<fx:Declarations>
		<mx:RemoteObject id="blazeDSClueService" destination="BlazeDSClueService"
			result="defaultServiceResultHandler(event);" fault="defaultServiceFaultHandler(event);">
		</mx:RemoteObject>
	</fx:Declarations>
	<!-- Telling someone to login -->
	<s:Group includeIn="login" width="100%" height="100%">
		<s:Group verticalCenter="0" horizontalCenter="0">
			<s:Rect radiusX="10" radiusY="10" width="100%" height="100%">
				<s:fill>
					<s:SolidColor color="#dddddd" />
				</s:fill>
				<s:stroke>
					<s:SolidColorStroke color="#bbbbbb" weight="10" />
				</s:stroke>
			</s:Rect>
			<s:VGroup paddingLeft="50" paddingRight="50" paddingTop="50"
				paddingBottom="50">
				<s:Label text="You must login first." />
			</s:VGroup>
		</s:Group>
	</s:Group>
	<!-- Main scene container. -->
	<s:VGroup width="100%" height="100%" includeIn="clueGroup">
		<!-- Cards and rooms. -->
		<s:HGroup width="100%" height="100%">
			<s:Panel id="cardsPanel" title="Cards" height="100%">
				<s:Scroller height="100%" width="100%">
					<s:VGroup id="cards" height="100%" horizontalAlign="center"
						paddingLeft="10" paddingRight="10" paddingTop="10" paddingBottom="10">
						<clue-components:Card cardName="test" />
						<clue-components:Card cardName="test" />
						<clue-components:Card cardName="test" />
						<clue-components:Card cardName="test" />
						<clue-components:Card cardName="test" />
					</s:VGroup>
				</s:Scroller>
			</s:Panel>
			<s:Panel id="roomsPanel" title="Rooms" width="100%" height="100%">
				<s:Rect width="100%" height="100%">
					<s:fill>
						<s:SolidColor color="#dddddd" />
					</s:fill>
				</s:Rect>
			</s:Panel>
		</s:HGroup>
		<s:HGroup width="100%">
			<s:Panel id="chatPanel" title="Chat" width="100%" height="100%">
				<s:layout>
					<s:VerticalLayout paddingLeft="10" paddingRight="10"
						paddingTop="10" paddingBottom="10" />
				</s:layout>
				<s:TextArea id="chat" width="100%" />
				<s:HGroup width="100%">
					<s:TextInput id="chatInput" width="100%" height="40"
						fontSize="32" />
					<mx:Button width="40" height="40" label="Chat"
						icon="@Embed(source='../resources/speech_icon.png')" />
				</s:HGroup>
			</s:Panel>
			<s:VGroup height="100%">
				<s:Button label="Suggest" fontSize="20" width="100%"
					height="100%" />
				<s:Button label="Accuse" fontSize="20" width="100%" height="100%" />
			</s:VGroup>
		</s:HGroup>
	</s:VGroup>
</s:Application>